///*
// * Copyright (c) 2016 the original author or authors.
// *
// * Licensed under the Apache License, Version 2.0 (the "License");
// * you may not use this file except in compliance with the License.
// * You may obtain a copy of the License at
// *
// *       http://www.apache.org/licenses/LICENSE-2.0
// *
// * Unless required by applicable law or agreed to in writing, software
// * distributed under the License is distributed on an "AS IS" BASIS,
// * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// * See the License for the specific language governing permissions and
// * limitations under the License.
// */
//
//package io;
//
//import org.junit.Test;
//
//import com.takin.emmet.io.traffic.shm.file.MappedFile;
//import com.takin.emmet.io.traffic.shm.queue.Block;
//import com.takin.emmet.io.traffic.shm.queue.Queue;
//import com.takin.emmet.io.traffic.util.Util;
//
///**
// * @author cuiyi
// */
//public class TestMappedFile {
//
//    @Test
//    public void testMap() throws Exception {
//        MappedFile mappedFile = MappedFile.with("/Users/peptos/shm", 200000L);
//        System.out.println(mappedFile.getAddress());
//    }
//
//    @Test
//    public void testQueue() throws Exception {
//        Queue queue = Queue.map("/Users/peptos/shm", 2000L, 1, 0);
//        queue.init();
//    }
//
//    @Test
//    public void testGet() throws Exception {
//        Queue queue = Queue.map("/Users/peptos/shm", 2000L, 1, 0);
//        queue.init();
//
//        Block block = queue.poll();
//        if (block != null) {
//            System.out.println(new String(block.getPayload(), "UTF-8"));
//        }
//    }
//
//    @Test
//    public void testPoll() throws Exception {
//        Queue queue = Queue.map("/Users/peptos/shm", 2000L, 1, 0);
//        queue.init();
//
//        long millis = 10 * 1;
//        while (true) {
//            Block block = queue.poll();
//            if (block != null) {
//                System.out.println(new String(block.getPayload(), "UTF-8"));
//            } else {
//                Util.pause(millis);
//            }
//        }
//    }
//
//    @Test
//    public void testOffer() throws Exception {
//        Queue queue = Queue.map("/Users/peptos/shm", 2000L, 1, 0);
//
//        for (int i = 0; i <= 30000; i++) {
//            String str = "----";
//            String string = str + i + str;
//            byte[] bytes = string.getBytes("UTF-8");
//
//            System.out.println(i + ":" + queue.put(new Block(bytes)));
//        }
//
//        queue.close();
//    }
//
//    @Test
//    public void testThread() throws Exception {
//        final Queue queue = Queue.map("/Users/peptos/shm", 2000L, 1, 0);
//
//        for (int thread = 0; thread < 10; thread++) {
//
//            final Thread t = new Thread(new Runnable() {
//                @Override
//                public void run() {
//                    for (int i = 0; i < 300; i++) {
//                        String str = "----";
//                        String string = str + Thread.currentThread().getName() + "|" + i + str;
//                        byte[] bytes = string.getBytes();
//                        boolean res = queue.put(new Block(bytes));
//                        System.out.println(Thread.currentThread().getName() + "|" + i + ":" + res);
//                    }
//                }
//            });
//            t.start();
//        }
//    }
//
//}
